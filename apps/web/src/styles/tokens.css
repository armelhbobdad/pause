/**
 * Guardian Design Tokens
 *
 * These design tokens define the visual language for the Guardian UI system.
 * All colors use oklch for perceptual uniformity across displays.
 *
 * @constraint UX-45: 13 custom properties (clarified from AC#1's "11" - actual spec lists 13)
 *
 * Token Categories:
 * - Guardian Pulse: Animation colors for the "analyzing" state
 * - Frost: Blur effect for card vault
 * - Negotiator: Savings/gold tier colors
 * - Therapist: Amber tier colors (gentle reflection)
 * - Card Vault: Base colors for frosted glass effect
 * - Transitions: Duration tokens (easing applied at component level)
 * - Typography: Font stack definitions
 */

/**
 * CSS @property registration for animatable custom properties.
 * Required for smooth CSS transitions on custom properties.
 * Per UX-42: Animation targets opacity not blur amount for 60fps guarantee.
 */
@property --frost-opacity {
  syntax: "<number>";
  initial-value: 1;
  inherits: false;
}

:root {
  /* Guardian Pulse Animation (Analyst tier - cool neutral)
     ADR-TOKEN-002: High lightness (L>=0.85) ensures pulse is visible against dark card background */
  --guardian-pulse-start: oklch(0.85 0.02 250);
  --guardian-pulse-end: oklch(0.92 0.01 250);

  /* Frost Blur
     ADR: 12px allows card's last 4 digits to remain visible as a teaser */
  --frost-blur: 12px;

  /* Negotiator Tier (warm gold - "found money" feeling)
     ADR-TOKEN-001: H=85 is true gold hue; C=0.18 is saturated enough to feel exciting */
  --savings-gold: oklch(0.75 0.18 85);
  --savings-gold-subtle: oklch(0.92 0.08 85);

  /* Therapist Tier (soft amber - gentle reflection)
     ADR: H=50 (not 55) avoids orange warning feel; lower chroma for softness */
  --therapist-amber: oklch(0.72 0.14 50);
  --therapist-amber-subtle: oklch(0.9 0.06 50);

  /* Card Vault (dark frosted glass base)
     ADR-TOKEN-002: L=0.2 provides contrast for pulse animation (L>=0.7 pulse vs L<=0.3 card) */
  --card-bg: oklch(0.2 0.02 250);
  --card-border: oklch(0.4 0.02 250);

  /* Transition Timing (duration only - easing applied at component level)
     ADR-TOKEN-003: 500ms reveal is "intentional action" range; 200ms expand keeps streaming snappy */
  --transition-reveal: 500ms;
  --transition-expand: 200ms;

  /* Card Reveal Animation (Story 2.3)
     ADR: Earned reveals use ease-out-expo for satisfying snap; override uses linear for mechanical feel */
  --duration-reveal: 600ms; /* Earned reveal: 500-700ms range (UX-01) */
  --duration-reveal-override: 350ms; /* Override reveal: 300-400ms range (UX-35) */
  --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1); /* Satisfying snap easing */

  /* Guardian Tier Max Heights (UX-55)
     ADR: Negotiator gets compact area (~5-6 lines); Therapist gets taller area (~8 lines) */
  --guardian-max-height-negotiator: 250px;
  --guardian-max-height-therapist: 350px;

  /* Guardian Pulse Animation Duration
     ADR: 2s cycle for subtle, non-distracting pulsing effect during active state */
  --pulse-duration: 2s;

  /* Error State (Story 2.6)
     ADR: --destructive already exists in Tailwind theme — use for error indicators
     --guardian-error-bg: Subtle warm-tinted background for error fallback area
     --duration-pulse-fade: Graceful pulse stop animation before error UI appears */
  --guardian-error-bg: oklch(0.95 0.03 22);
  --duration-pulse-fade: 300ms;

  /* Auto-Relock Timer (Story 9.4)
     ADR: oklch colors for perceptual uniformity; green→yellow→red depletion */
  --relock-green: oklch(0.72 0.18 145);
  --relock-yellow: oklch(0.78 0.16 85);
  --relock-red: oklch(0.65 0.22 25);
  --relock-bar-height: 3px;

  /* Typography
     ADR: Geist Sans is Next.js default; JetBrains Mono for data/codes
     Note: Uses CSS variables from next/font/google loaded in layout.tsx */
  --font-conversation:
    var(--font-geist-sans), "Geist Sans", system-ui, sans-serif;
  --font-data:
    var(--font-jetbrains-mono), "JetBrains Mono", ui-monospace, monospace;

  /* ==========================================================================
   * Pause Design Tokens (Epic 10 — Purification)
   * Token migration: ADDITIVE ONLY — no renaming/removal of existing tokens
   * All colors use oklch() for perceptual uniformity
   * ========================================================================== */

  /* Guardian State Colors */
  --pause-active: oklch(0.8 0.15 80);
  --pause-success: oklch(0.6 0.2 145);
  --pause-glass: oklch(1 0 0 / 5%);
  --pause-scrim: oklch(0 0 0 / 60%);

  /* Blur Tokens */
  --pause-blur-heavy: 20px;
  --pause-blur-medium: 10px;
  --pause-blur-light: 5px;

  /* Timing Tokens */
  --pause-timing-breathe: 4s;
  --pause-timing-ripple: 600ms;
  --pause-timing-glow: 1200ms;
  --pause-timing-collapse: 400ms;
  --pause-timing-reveal: 1500ms;

  /* Transition Tokens */
  --pause-transition-fast: 150ms;
  --pause-transition-normal: 250ms;

  /* Z-Index Tokens */
  --z-base: 0;
  --z-card: 10;
  --z-float: 100;
  --z-overlay: 200;
  --z-toast: 300;
  --z-tooltip: 400;

  /* Elevation Border Tokens */
  --pause-border-base: oklch(1 0 0 / 10%);
  --pause-border-elevated: oklch(1 0 0 / 15%);
  --pause-border-modal: oklch(1 0 0 / 20%);

  /* Spacing Tokens */
  --space-1: 0.25rem;
  --space-2: 0.5rem;
  --space-3: 0.75rem;
  --space-4: 1rem;
  --space-5: 1.25rem;
  --space-6: 1.5rem;
  --space-8: 2rem;
  --space-10: 2.5rem;
  --space-12: 3rem;
  --space-16: 4rem;
}

/* Shimmer Loading Animation (Story 4.4, AC#5)
   Sliding gradient for tool-call loading state */
@keyframes shimmer {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

/* Breath Beat Entry Animation (Story 4.4, UX-53)
   200ms delay before tool component appears — fade-in with slight rise */
@keyframes breath-beat-enter {
  from {
    opacity: 0;
    transform: translateY(4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Savings Ticket Entry Animation (Story 4.3, UX-53, UX-04)
   translateY(-12px) → 0 slide-up with fade-in over 800ms using --ease-out-expo */
@keyframes savings-ticket-enter {
  from {
    opacity: 0;
    transform: translateY(-12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Ghost Card Feedback Flash (Story 6.4)
   Brief gold/amber highlight when user submits satisfaction feedback */
@keyframes ghost-feedback-flash {
  0% {
    background-color: var(--card-bg);
  }
  30% {
    background-color: oklch(0.3 0.04 85);
  }
  100% {
    background-color: var(--card-bg);
  }
}

/* First-Interaction Celebration Pulse (Story 7.5, AC#4)
   Gentle scale pulse on newly populated sections — GPU-composited only (UX-37) */
@keyframes celebrate-pulse {
  0% {
    transform: scale(1.02);
  }
  100% {
    transform: scale(1);
  }
}

/* Ghost Card reduced-motion: instant de-frost (Story 6.4, AC4) */
@media (prefers-reduced-motion: reduce) {
  [data-ghost-id],
  [data-celebrate] {
    transition-duration: 0ms !important;
    animation-duration: 0ms !important;
  }
}

/* Backdrop-filter fallback (Story 10.1, AC#1)
   For browsers that don't support backdrop-filter */
@supports not (backdrop-filter: blur(10px)) {
  .glass-panel,
  .card-vault,
  [data-glass] {
    background: linear-gradient(
      135deg,
      oklch(0.15 0.02 250 / 95%),
      oklch(0.12 0.01 250 / 98%)
    );
    border-color: oklch(1 0 0 / 20%);
  }
}

/* High contrast mode support (Story 10.1, AC#1)
   Ensures interactive elements remain visible in forced-colors mode */
/* Focused Mode — navbar items dimmed during active Guardian session (Story 10.5) */
[data-navbar].focused-mode a {
  opacity: 0.4;
  cursor: default;
  pointer-events: none;
}

/* Landing Page Card Preview Breathing Animation (Story 10.4)
   CSS-only approach mandated for parallel worktree safety with Story 10.2.
   Uses --pause-timing-breathe (4s) for visual continuity with dashboard card. */
@keyframes card-breathe {
  0%,
  100% {
    transform: scale(1);
    opacity: 0.85;
  }
  50% {
    transform: scale(1.02);
    opacity: 1;
  }
}

@media (prefers-reduced-motion: reduce) {
  .landing-card-breathe {
    animation: none !important;
  }
}

@media (forced-colors: active) {
  .card,
  .glass-panel,
  .card-vault,
  button,
  a {
    border: 1px solid ButtonText;
  }
}
